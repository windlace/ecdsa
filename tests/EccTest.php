<?php

namespace Cast\Crypto\ECDSA\Tests;

use function Cast\Crypto\ECDSA\ECC\ECdouble;
use function Cast\Crypto\ECDSA\ECC\ECadd;
use function Cast\Crypto\ECDSA\ECC\EccMultiply;
use PHPUnit\Framework\TestCase;

class EccTest extends TestCase
{
    function test_ECdouble()
    {
        $this->assertEquals(
            [
                '89565891926547004231252920425935692360644145829622209833684329913297188986597',
                '12158399299693830322967808612713398636155367887041628176798871954788371653930',
            ],
            array_map(
                'gmp_strval',
                ECdouble(
                    [
                        gmp_init('55066263022277343669578718895168534326250603453777594175500187360389116729240'),
                        gmp_init('32670510020758816978083085130507043184471273380659243275938904335757337482424'),
                    ],
                    0x0000000000000000000000000000000000000000000000000000000000000000,
                    gmp_init('115792089237316195423570985008687907853269984665640564039457584007908834671663')
                )
            )
        );
    }

    function test_ECadd()
    {
        $this->assertEquals(
            [
                '112711660439710606056748659173929673102114977341539408544630613555209775888121',
                '25583027980570883691656905877401976406448868254816295069919888960541586679410',
            ],
            array_map(
                'gmp_strval',
                ECadd(
                    [
                        gmp_init('89565891926547004231252920425935692360644145829622209833684329913297188986597'),
                        gmp_init('12158399299693830322967808612713398636155367887041628176798871954788371653930'),
                    ],
                    [
                        gmp_init('55066263022277343669578718895168534326250603453777594175500187360389116729240'),
                        gmp_init('32670510020758816978083085130507043184471273380659243275938904335757337482424'),
                    ],
                    gmp_init('115792089237316195423570985008687907853269984665640564039457584007908834671663')
                )
            )
        );
    }

    function test_EccMultiply()
    {
        $this->assertEquals(
            [
                '36422191471907241029883925342251831624200921388586025344128047678873736520530',
                '20277110887056303803699431755396003735040374760118964734768299847012543114150',
            ],
            array_map(
                'gmp_strval',
                EccMultiply(
                    '18e14a7b6a307f426a94f8114701e7c8e774e7f9a47e2c2035db29a206321725',
                    [
                        gmp_init('55066263022277343669578718895168534326250603453777594175500187360389116729240'),
                        gmp_init('32670510020758816978083085130507043184471273380659243275938904335757337482424'),
                    ],
                    gmp_init('115792089237316195423570985008687907852837564279074904382605163141518161494337'),
                    0x0000000000000000000000000000000000000000000000000000000000000000,
                    gmp_init('115792089237316195423570985008687907853269984665640564039457584007908834671663')
                )
            )
        );
    }
}
